webpackJsonp([1,7],{1249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(52),a=n(27),o=n(255),r=n(1260),c=n(1271),l=n(1257);n.d(t,"StreamModule",function(){return p});var d=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(t,n,o):s(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(){function e(){}return e=d([n.i(i.NgModule)({imports:[s.a,a.a,o.a,c.a],declarations:[l.a,r.a],providers:[{provide:Window,useValue:window}]}),u("design:paramtypes",[])],e)}()},1257:function(e,t,n){"use strict";var i=n(0),s=n(676),a=n(403),o=n(1270),r=n(1274);n.d(t,"a",function(){return u});var c=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(t,n,o):s(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},d=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}},u=function(){function e(e,t,n){this.window=e,this.socket=t,this.auth=n,this.viewerCount=0,this.intervalID=0,this.unreadMessages=0,this.settings=o.a,this.title=this.window.document.title}return Object.defineProperty(e.prototype,"messages",{get:function(){var e=JSON.parse(localStorage.getItem("chatMessages"))||{};return e[this.currentPlaylist]||[]},set:function(e){var t=JSON.parse(localStorage.getItem("chatMessages"))||{};t[this.currentPlaylist]=e,localStorage.setItem("chatMessages",JSON.stringify(t))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.setupUser(this.auth.user),this.auth.userInfo.subscribe(function(t){e.setupUser(t)})},e.prototype.onPlayerReady=function(){var e=this;console.log("onPlayerReady"),this.socket.on(r.a.ViewerCount,function(t){e.viewerCount=t}),this.socket.on(r.b.Connect,function(t){console.log("chat connect",t),e.addMessage({user:"YOC",text:t+" connected!",playlist:e.currentPlaylist,timestamp:Date.now()})}),this.socket.on(r.b.Disconnect,function(t){e.addMessage({user:"YOC",text:t+" disconnected!",playlist:e.currentPlaylist,timestamp:Date.now()})}),console.log(r.b.Message),this.socket.on(r.b.Message,function(t){if(console.log("chat message",t),t.playlist===e.currentPlaylist){for(var n=t.text.match(/https?:\/\/\S+/gi)||[],i=0,s=n;i<s.length;i++){var a=s[i];t.text=t.text.replace(a,'<a target="_blank" href="'+a+'">'+a+"</a>")}if(e.addMessage(t),e.isTabbedAway()){e.unreadMessages++;var o=!0;0!==e.intervalID&&e.window.clearInterval(e.intervalID),e.intervalID=e.window.setInterval(function(){o?e.updateTitle():e.window.document.title=t.user+" sent a message!",o=!o},1e3);var c=new Notification("New message from "+t.user,{body:t.text,icon:"/assets/images/yoc.png",tag:r.b.Message});c.onclick=function(t){c.close(),e.window.focus()},e.window.setTimeout(c.close.bind(c),3e3)}}}),"denied"===Notification.permission&&"granted"===Notification.permission||Notification.requestPermission(),void 0!==this.window.document.hidden?(this.hiddenAttr="hidden",this.visChangeEvent="visibilitychange"):void 0!==this.window.document.msHidden?(this.hiddenAttr="msHidden",this.visChangeEvent="msvisibilitychange"):void 0!==this.window.document.webkitHidden&&(this.hiddenAttr="webkitHidden",this.visChangeEvent="webkitvisibilitychange"),this.window.document.addEventListener(this.visChangeEvent,function(){e.isTabbedAway()||(e.unreadMessages=0,e.window.clearInterval(e.intervalID),e.intervalID=0,e.updateTitle())})},e.prototype.onPlaylistItem=function(e){this.currentPlaylist=e.item.title,this.messages||(this.messages=[]);var t=Date.now(),n=this.messages.filter(function(e){var n=864e5,i=t-e.timestamp;return i<n});this.messages=n},e.prototype.sendChat=function(e){13===e.keyCode&&""!==this.text&&(this.socket.emit("chat:message",{user:this.user,text:this.text,playlist:this.currentPlaylist,timestamp:Date.now()}),this.text="",e.preventDefault())},e.prototype.isTabbedAway=function(){return this.window.document[this.hiddenAttr]},e.prototype.updateTitle=function(){this.unreadMessages>0?this.window.document.title="("+this.unreadMessages+") "+this.title:this.window.document.title=this.title},e.prototype.addMessage=function(e){var t=this.messages;t.unshift(e),this.messages=t},e.prototype.generateGuestName=function(){var e=Math.floor(1e4*Math.random());this.user="Guest#"+e},e.prototype.setupUser=function(e){e?(this.user=e.name,this.socket.emit(r.b.Connect,this.user)):this.generateGuestName()},e=c([n.i(i.Component)({selector:"app-stream",template:n(1283),styles:[n(1278)]}),d(0,n.i(i.Inject)(Window)),l("design:paramtypes",[Object,"function"==typeof(t="undefined"!=typeof s.a&&s.a)&&t||Object,"function"==typeof(u="undefined"!=typeof a.a&&a.a)&&u||Object])],e);var t,u}()},1260:function(e,t,n){"use strict";var i=n(0);n.d(t,"a",function(){return o});var s=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(t,n,o):s(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=function(){function e(e){this.elementRef=e,this.ready=new i.EventEmitter,this.playlistItem=new i.EventEmitter,this.error=new i.EventEmitter}return Object.defineProperty(e.prototype,"Player",{get:function(){return this.player},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){var e=this;this.player=jwplayer(this.playerRef.nativeElement).setup(this.settings),this.player.onReady(function(){e.ready.emit()})},e.prototype.ngOnDestroy=function(){this.player.remove()},s([n.i(i.Input)(),a("design:type",Object)],e.prototype,"settings",void 0),s([n.i(i.Output)(),a("design:type",Object)],e.prototype,"ready",void 0),s([n.i(i.Output)(),a("design:type",Object)],e.prototype,"playlistItem",void 0),s([n.i(i.Output)(),a("design:type",Object)],e.prototype,"error",void 0),s([n.i(i.ViewChild)("player"),a("design:type","function"==typeof(t="undefined"!=typeof i.ElementRef&&i.ElementRef)&&t||Object)],e.prototype,"playerRef",void 0),e=s([n.i(i.Component)({selector:"jwplayer",template:"\n        <div #player></div>\n    "}),a("design:paramtypes",["function"==typeof(o="undefined"!=typeof i.ElementRef&&i.ElementRef)&&o||Object])],e);var t,o}()},1270:function(e,t,n){"use strict";t.a={playlist:[{image:"/assets/images/yoc.png",title:"Default",description:"Stream stuff, mane",file:"rtmp://eon.adam-keenan.net/live/default"},{title:"TEST",description:"Nothing to see here",file:"rtmp://eon.adam-keenan.net/live/test"},{title:"Movienight",description:"We watch movies together",file:"rtmp://eon.adam-keenan.net/live/movienight"},{title:"Mike",description:"Mike plays gams",file:"rtmp://eon.adam-keenan.net/live/mike"}],width:"100%",aspectratio:"16:9",hlshtml:!0,primary:"html5",autostart:"yoc.adam-keenan.com"===window.location.hostname||!0,skin:{name:"glow"},logo:{file:"/assets/images/yoc-100px-50a.png",hide:!0}}},1271:function(e,t,n){"use strict";var i=n(0),s=n(402),a=n(1257);n.d(t,"a",function(){return l});var o=this&&this.__decorate||function(e,t,n,i){var s,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(t,n,o):s(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=[{path:"",component:a.a}],l=function(){function e(){}return e=o([n.i(i.NgModule)({imports:[s.a.forChild(c)],exports:[s.a]}),r("design:paramtypes",[])],e)}()},1273:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i;!function(e){e.Connect="chat:connect",e.Disconnect="chat:disconnect",e.Message="chat:message"}(i||(i={}))},1274:function(e,t,n){"use strict";var i=n(1273);n.d(t,"b",function(){return i.a});var s=n(1275);n.d(t,"a",function(){return s.a})},1275:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i;!function(e){e.ViewerCount="stream:viewerCount"}(i||(i={}))},1278:function(e,t){e.exports=".stream .player{position:absolute;left:15px;width:calc(100% - 400px - 45px)}.stream .player .status{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;background:#d3d3d3;padding:5px}.stream .chat{position:absolute;right:15px;top:75px;bottom:15px;width:400px}.stream .chat textarea{height:50px;resize:none}.stream .chat .mat-list{margin-top:-17px;overflow-y:auto;height:calc(100% - 79px);word-break:break-word}.stream .chat .mat-list .message{color:rgba(0,0,0,0.87)}.stream .chat .mat-list .message:nth-child(even){background-color:rgba(0,0,0,0.1)}\n"},1283:function(e,t){e.exports="<div class='stream'>\n    <div class='player'>\n        <jwplayer [settings]='settings' (ready)='onPlayerReady()' (playlistItem)='onPlaylistItem($event)'></jwplayer>\n        <div class='status'>\n            <md-icon>person</md-icon>\n            <span>{{ viewerCount }}</span>\n        </div>\n    </div>\n    <div class='chat'>\n        <md-input-container class='w100p'>\n            <textarea mdInput placeholder='Send a message' [(ngModel)]='text' (keypress)='sendChat($event)'></textarea>\n        </md-input-container>\n        <md-list dense>\n            <div class='message' *ngFor='let message of messages'>\n                <md-list-item>\n                    <!-- To make the small text line up -->\n                    <div>\n                        <small>{{ message.timestamp | date:\"shortTime\" }}</small>&nbsp;\n                        <span>{{ message.user }}:&nbsp;</span>\n                        <span>{{ message.text }}</span>\n                    </div>\n                </md-list-item>\n                <md-divider></md-divider>\n            </div>\n        </md-list>\n    </div>\n</div>\n"}});